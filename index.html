<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus AI - Firebase YÃ¶netim Merkezi</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>

    <style>
        /* GENEL TASARIM */
        :root { --primary: #00ff88; --danger: #ff4d4d; --glass: rgba(255, 255, 255, 0.1); --text: #ffffff; }
        body, html { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #0f2027, #2c5364); height: 100vh; color: var(--text); overflow-x: hidden; }
        
        .auth-container { display: flex; justify-content: center; align-items: center; height: 100vh; }
        .glass-box { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.2); padding: 40px; border-radius: 20px; width: 350px; text-align: center; }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; background: rgba(255,255,255,0.05); color: white; box-sizing: border-box; }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; background: var(--primary); color: #000; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        
        /* TÄ°K ANÄ°MASYONU */
        #success-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; justify-content: center; align-items: center; z-index: 9999; }
        .checkmark { width: 100px; height: 100px; border-radius: 50%; stroke: #fff; stroke-width: 2; animation: fill .4s ease-in-out .4s forwards; }
        @keyframes fill { 100% { box-shadow: inset 0px 0px 0px 50px var(--primary); } }

        /* PANEL */
        #admin-panel { display: none; padding: 30px; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: var(--glass); padding: 20px; border-radius: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .content-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .panel-section { background: var(--glass); padding: 20px; border-radius: 15px; height: 400px; overflow-y: auto; }
        .user-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .btn-sm { width: auto; padding: 5px 10px; font-size: 12px; }

        /* BÄ°LDÄ°RÄ°M KUTUSU TASARIMI */
        .notif-card {
            position: fixed; bottom: 20px; right: 20px; width: 320px; padding: 20px; z-index: 10000;
            display: none; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.2);
            background: var(--glass); backdrop-filter: blur(15px); box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            animation: slideUp 0.5s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .notif-content { display: flex; align-items: center; margin-bottom: 15px; }
        .notif-icon { font-size: 30px; margin-right: 15px; }
        .notif-text h4 { margin: 0; color: var(--primary); }
        .notif-text p { margin: 5px 0 0; font-size: 0.85rem; opacity: 0.8; }
        .notif-buttons { display: flex; gap: 10px; }
        .btn-allow { background: var(--primary) !important; color: #000 !important; }
        .btn-close { background: rgba(255,255,255,0.1) !important; color: #fff !important; }
    </style>
</head>
<body>

    <div id="success-overlay">
        <svg class="checkmark" viewBox="0 0 52 52"><circle cx="26" cy="26" r="25" fill="none" stroke="#00ff88" stroke-width="2"/><path fill="none" stroke="#00ff88" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg>
        <h2 style="margin-top:20px">Sisteme BaÄŸlanÄ±ldÄ±</h2>
    </div>

    <div id="auth-screen" class="auth-container">
        <div class="glass-box">
            <h1 style="color: var(--primary);">Nexus AI</h1>
            <input type="email" id="email" placeholder="Email">
            <input type="password" id="pass" placeholder="Åžifre">
            <button onclick="login()">GÃ¼venli GiriÅŸ</button>
        </div>
    </div>

    <div id="admin-panel">
        <header style="display:flex; justify-content: space-between;">
            <h2>Nexus AI - Patron Paneli</h2>
            <button onclick="logout()" style="width:100px">Ã‡Ä±kÄ±ÅŸ</button>
        </header>

        <div class="dashboard-grid">
            <div class="stat-card"><h3>Aktif KullanÄ±cÄ±</h3><h2 id="activeCount">0</h2></div>
            <div class="stat-card"><h3>Toplam ZiyaretÃ§i</h3><h2 id="visitorCount">0</h2></div>
            <div class="stat-card"><h3>Yeni Ã–neriler</h3><h2 id="sugCount">0</h2></div>
        </div>

        <div class="content-grid">
            <div class="panel-section">
                <h3>KullanÄ±cÄ± KontrolÃ¼</h3>
                <div id="user-list"></div>
            </div>
            <div class="panel-section">
                <h3>Gelen Ã–neriler</h3>
                <div id="suggestion-list"></div>
            </div>
        </div>
    </div>

    <div id="notification-box" class="notif-card">
        <div class="notif-content">
            <div class="notif-icon">ðŸ””</div>
            <div class="notif-text">
                <h4>Yeniliklerden Haberdar Ol!</h4>
                <p>Nexus AI gÃ¼ncellemelerini ve yeni Ã¶zellikleri kaÃ§Ä±rmamak iÃ§in bildirimleri aÃ§Ä±n.</p>
            </div>
        </div>
        <div class="notif-buttons">
            <button onclick="closeNotif('allowed')" class="btn-allow">Bildirimleri AÃ§</button>
            <button onclick="closeNotif('denied')" class="btn-close">Daha Sonra</button>
        </div>
    </div>

    <script>
        // FIREBASE CONFIG - Patron burayÄ± doldurmayÄ± unutma
        const firebaseConfig = {
            apiKey: "AIzaSyCb7Ldqw_5jbLo6tcq93bPpK-O9uVb4fXU",
            authDomain: "deselwallet-3345f.firebaseapp.com",
            databaseURL: "https://deselwallet-3345f-default-rtdb.europe-west1.firebasedatabase.app/",
            projectId: "deselwallet-3345f",
            storageBucket: "deselwallet-3345f.firebasestorage.app",
            messagingSenderId: "408489830274",
            appId: "1:408489830274:web:2fa8ff3d989e23efb1519b"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();

        function login() {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('pass').value;
            auth.signInWithEmailAndPassword(email, pass)
                .then(() => {
                    document.getElementById('auth-screen').style.display = 'none';
                    document.getElementById('success-overlay').style.display = 'flex';
                    setTimeout(() => {
                        document.getElementById('success-overlay').style.display = 'none';
                        document.getElementById('admin-panel').style.display = 'block';
                        loadData();
                    }, 2000);
                })
                .catch(err => alert("Hata: " + err.message));
        }

        function loadData() {
            database.ref('stats/visitors').on('value', snap => { document.getElementById('visitorCount').innerText = snap.val() || 0; });
            database.ref('users').on('value', snap => {
                const list = document.getElementById('user-list');
                list.innerHTML = "";
                let count = 0;
                snap.forEach(user => {
                    count++;
                    const data = user.val();
                    list.innerHTML += `<div class="user-item">
                        <span>${data.username} (${data.isBlocked ? 'Engelli' : 'Aktif'})</span>
                        <button class="btn-sm" style="background:${data.isBlocked ? '#00ff88' : '#ff4d4d'}" onclick="toggleBlock('${user.key}', ${data.isBlocked})">${data.isBlocked ? 'KaldÄ±r' : 'Engelle'}</button>
                    </div>`;
                });
                document.getElementById('activeCount').innerText = count;
            });
            database.ref('suggestions').on('value', snap => {
                const list = document.getElementById('suggestion-list');
                list.innerHTML = "";
                let sCount = 0;
                snap.forEach(sug => { sCount++; const d = sug.val(); list.innerHTML += `<div style="background:rgba(0,0,0,0.2); padding:10px; margin-bottom:5px; border-radius:10px;"><strong>${d.email}:</strong> <p>${d.text}</p></div>`; });
                document.getElementById('sugCount').innerText = sCount;
            });
        }

        function toggleBlock(uid, currentStatus) { database.ref('users/' + uid).update({ isBlocked: !currentStatus }); }
        function logout() { auth.signOut(); location.reload(); }

        // BÄ°LDÄ°RÄ°M MANTIÄžI
        window.addEventListener('load', () => {
            setTimeout(() => {
                if (!localStorage.getItem('notif_preference')) {
                    document.getElementById('notification-box').style.display = 'block';
                }
            }, 3000);
        });

        function closeNotif(status) {
            localStorage.setItem('notif_preference', status);
            const box = document.getElementById('notification-box');
            box.style.transition = '0.5s';
            box.style.transform = 'translateY(150px)';
            box.style.opacity = '0';
            setTimeout(() => { box.style.display = 'none'; }, 500);
            if(status === 'allowed') alert("Bildirimler aktif edildi patron!");
        }
    </script>
</body>
</html>
